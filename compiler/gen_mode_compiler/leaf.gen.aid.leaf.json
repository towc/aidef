{
  "path": "/home/user/git/github/towc/aidef/compiler/gen_mode_compiler/leaf.gen.aid.leaf.json",
  "dir": "/home/user/git/github/towc/aidef/compiler/gen_mode_compiler",
  "prompt": "\n    Create a compiler for `.gen.aid` files, responsible for the \"gen mode\" described in the specification.\n\n    It should export a function:\n    - `compileGenAid(genAidContent: string, currentPath: string, tools: { gen_node: Function, gen_leaf: Function }): Promise<void>`\n\n    Behavior:\n    1.  **Parse**: Use the `aid_parser` (from the `aid_parser` leaf) to parse the `genAidContent`.\n    2.  **LLM Processing**:\n        -   Inject appropriate system prompts to guide the LLM.\n        -   The LLM will interpret the parsed `.aid` content.\n        -   The LLM will use the provided `gen_node` and `gen_leaf` tools to create child nodes and leaves.\n    3.  **Child Node Generation**:\n        -   If the LLM calls `gen_node(name, content)`, create a folder `./<name>` relative to `currentPath`.\n        -   Inside this folder, create a file `node.gen.aid` with the provided `content`.\n    4.  **Leaf Node Generation**:\n        -   If the LLM calls `gen_leaf(name, prompt, files, commands)`, create a folder `./<name>` relative to `currentPath`.\n        -   Inside this folder, create a file `leaf.gen.aid.leaf.json` with the following JSON structure:\n            ```json\n            {\n              \"prompt\": \"string\",\n              \"files\": [\"string\"],\n              \"commands\": [\"string\"]\n            }\n            ```\n        -   Ensure the `prompt` contains all relevant instructions and interfaces.\n        -   The `files` array should be directly from the `gen_leaf` call.\n        -   The `commands` array should be directly from the `gen_leaf` call.\n    5.  **Tree Diffing (Conceptual)**: While this module doesn't implement tree diffing directly, it should be designed with the understanding that its output (the generated `node.gen.aid` and `leaf.gen.aid.leaf.json` files) will be used for tree diffing. Therefore, the generation process should aim for predictability (e.g., low temperature for AI calls).\n    6.  **File Overlap Check**: Implement a lightweight check during compilation to ensure that no two leaves attempt to write to the same file. If a conflict is detected, it should raise a compile-time error.\n    ",
  "files": [
    "gen_compiler.ts",
    "node_generator.ts",
    "leaf_generator.ts",
    "file_overlap_checker.ts"
  ],
  "commands": []
}